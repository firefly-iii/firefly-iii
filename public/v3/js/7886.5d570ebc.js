"use strict";(self["webpackChunkfirefly_iii"]=self["webpackChunkfirefly_iii"]||[]).push([[7886],{8482:(t,e,a)=>{a.r(e),a.d(e,{default:()=>x});var s=a(9835),n=a(6970);const i={class:"q-mt-sm q-mr-sm"},r=(0,s._)("strong",null," Budgets ",-1),o={class:"row"},l={class:"col"},u={class:"row"},d={class:"col"},c=(0,s._)("br",null,null,-1),g=(0,s._)("br",null,null,-1),m=(0,s._)("div",{class:"col"}," I am bar ",-1),p=(0,s._)("div",{class:"row"},[(0,s._)("div",{class:"col"},[(0,s.Uk)(" I am no budget"),(0,s._)("br")])],-1);function f(t,e,a,f,h,_){const w=(0,s.up)("q-item-label"),b=(0,s.up)("q-item-section"),v=(0,s.up)("q-item"),y=(0,s.up)("q-separator"),B=(0,s.up)("router-link"),D=(0,s.up)("q-card-section"),k=(0,s.up)("q-card");return(0,s.wg)(),(0,s.iD)("div",i,[(0,s.Wm)(k,{bordered:""},{default:(0,s.w5)((()=>[(0,s.Wm)(v,null,{default:(0,s.w5)((()=>[(0,s.Wm)(b,null,{default:(0,s.w5)((()=>[(0,s.Wm)(w,null,{default:(0,s.w5)((()=>[r])),_:1})])),_:1})])),_:1}),(0,s.Wm)(y),(0,s.Wm)(D,null,{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(h.budgets,(t=>((0,s.wg)(),(0,s.iD)("div",{key:t.id},[(0,s._)("div",o,[(0,s._)("div",l,[(0,s.Wm)(B,{to:{name:"budgets.show",params:{id:t.id}}},{default:(0,s.w5)((()=>[(0,s.Uk)((0,n.zw)(t.name),1)])),_:2},1032,["to"])])]),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(t.limits,(t=>((0,s.wg)(),(0,s.iD)("div",null,[(0,s._)("div",u,[(0,s._)("div",d,[(0,s._)("small",null,(0,n.zw)(_.formatAmount(t.currency_code,t.amount)),1),c,(0,s.Uk)(" "+(0,n.zw)(_.formatDate(t.start)),1),g,(0,s.Uk)(" "+(0,n.zw)(_.formatDate(t.end)),1)]),m])])))),256))])))),128)),p])),_:1})])),_:1})])}var h=a(3555),_=a(1569);class w{list(t){let e="/api/v2/budgets";return _.api.get(e,{params:{page:t}})}}var b=a(8898);class v{list(t,e,a,s){let n="/api/v2/budgets/"+t+"/limits",i=(0,b.Z)(e,"y-MM-dd"),r=(0,b.Z)(a,"y-MM-dd");return _.api.get(n,{params:{page:s,start:i,end:r}})}}const y={name:"BudgetBox",data(){return{budgets:[],locale:"en-US",page:1,loadingBudgets:!1,dateFormat:""}},mounted(){this.store=(0,h.S)(),this.dateFormat=this.$t("config.month_and_day_fns"),this.store.$onAction((({name:t,store:e,args:a,after:s,onError:n})=>{s((e=>{"setRange"===t&&(this.locale=this.store.getLocale,this.loadBox())}))})),null!==this.store.getRange.start&&null!==this.store.getRange.end&&this.loadBox()},methods:{formatDate:function(t){return(0,b.Z)(new Date(t),this.$t("config.month_and_day_fns"))},formatAmount:function(t,e){return Intl.NumberFormat("en-US",{style:"currency",currency:t}).format(e)},loadBox:function(){this.loadingBudgets=!0,(new w).list(this.page).then((t=>{if(this.parseBudgets(t.data.data),t.data.meta.pagination.current_page<t.data.meta.pagination.total_pages)return this.page=t.data.meta.pagination.current_page+1,void this.loadBox();this.loadingBudgets=!1,this.processBudgets()}))},parseBudgets:function(t){for(let e in t)if(t.hasOwnProperty(e)){const a=t[e];this.budgets.push({id:parseInt(a.id),name:a.attributes.name,limits:[]})}},processBudgets:function(){for(let t in this.budgets)if(this.budgets.hasOwnProperty(t)){const e=this.budgets[t];(new v).list(e.id,this.store.getRange.start,this.store.getRange.end,1).then((t=>{this.parseBudgetLimits(t.data.data,e)}))}console.log("Processing...")},parseBudgetLimits:function(t,e){console.log("Parse for "+e.name);for(let a in t)if(t.hasOwnProperty(a)){const s=t[a];e.limits.push({amount:s.attributes.amount,currency_code:s.attributes.currency_code,start:new Date(s.attributes.start),end:new Date(s.attributes.end)}),console.log(s)}}}};var B=a(1639),D=a(4458),k=a(490),Z=a(1233),q=a(3115),I=a(926),W=a(3190),Q=a(9984),S=a.n(Q);const U=(0,B.Z)(y,[["render",f]]),x=U;S()(y,"components",{QCard:D.Z,QItem:k.Z,QItemSection:Z.Z,QItemLabel:q.Z,QSeparator:I.Z,QCardSection:W.Z})}}]);